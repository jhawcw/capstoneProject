<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
    <script src="../assets/components/jquery/jquery.min.js"></script>
    <script src="../assets/components/jquery/purl.js"></script>
    <script>
      if (this.location.href.indexOf("callback?code") > -1) {
        callServerAPIs(); // call the backend server APIs
      } else if (this.location.href.indexOf("callback") > -1) {
        alert("ERROR:" + JSON.stringify("Missing Auth Code"));
      }

      // ---START---CALL SERVER API - calling server side APIs (token & person) to get the person data for prefilling form
      function callServerAPIs() {
        var authCode = $.url(this.location.href).param("code");
        var state = $.url(this.location.href).param("state");
        console.log("Auth Code:", authCode);
        console.log("State:", state);

        // invoke AJAX call from frontend client side to your backend server side
        $.ajax({
          url: "/getPersonData",
          data: {
            authCode: authCode,
            state: state,
          },
          type: "POST", // post to server side
          success: function (result) {
            console.log("result", result);
          },
          error: function (result) {
            alert("ERROR:" + JSON.stringify(result.responseJSON.error));
          },
        });
      }
      // ---END---CALL SERVER API - calling server side APIs (token & person) to get the person data for prefilling form
    </script>
  </head>
  <body></body>
</html>
